#:kivy 1.0.9



<LoginPage>:
    BoxLayout:
        size_hint: None, None
        orientation: "vertical"
        size: self.parent.width * .9, self.parent.height *.9
        pos: (root.width - self.width) /2, (root.height - self.height) /2

        Widget:
            size_hint: 1, .2

        Label:
            size_hint: 1, .1
            text: ""
            color: error

        TextInput:
            hint_text: 'Username'
            multiline: False
            background_color: background
            foreground_color: superbright
            hint_text_color: bright
            size_hint: 1, .25

        Widget:
            size_hint: 1, .1

        Label:
            size_hint: 1, .1
            text: "Select Colour"
            color: superbright
        ColorInput:
            size_hint: 1, .1

        Widget:
            size_hint: 1, .1

        GridLayout:
            cols: 2
            rows: 2
            spacing: 10
            size_hint: 1, .25
        
            CheckBox:
                id: licence
                size_hint_x: root.width * 0.08

            Label:
                text: " I accept this license agreement."
                halign:'left'
                valign:'middle'
                size_hint_x: root.width * 0.9
                text_size: self.size

            CheckBox:
                id: terms
                size_hint_x: 1

            Label:
                text: " I accept these terms of use."
                halign:'left'
                valign:'middle'
                size_hint_x: root.width * 0.9
                text_size: self.size

        Widget:
            size_hint: 1, .1

        BoxLayout:
            orientation: "vertical"
            width: self.parent.width * .9
            pos: ((root.width - self.width) / 2), ((root.height - self.height) / 2) - root.height /7

            Button:
                text: "Sign up"
                width: 0.9 * root.width
                height: 30
                color: superbright
                background_color: buttonbackground
                hint_text_color: bright
                border_width: 0

                on_press: run(self.parent.parent.parent.signup())

            Widget:
                size_hint: 1, 1

            Label:
                text: "Already have an account?"

            Button:
                text: "Import account"
                width: 0.9 * root.width
                height: 30
                color: superbright
                background_color: buttonbackground
                hint_text_color: bright
                border_width: 0

                on_press: run(self.parent.parent.parent.login())


        Image:
            source: "app/images/logo.png"
            size_hint: None, None
            size: self.parent.width, self.parent.height *.2
            center: self.parent.width/2, self.parent.children[1].pos[1] / 2
            allow_stretch: True


<UsersPage>:
    size_hint: 1, 1
    pos: 0, 0


    BoxLayout:
        orientation: "vertical"
        size: root.width, root.height
        

        BoxLayout:
            orientation: "horizontal"
            size_hint: 1, .1
            padding: 5
            spacing: self.width/100

            Button:
                background_color: 0,0,0,0
                size_hint: .2, 1
                on_press: run(self.parent.parent.parent.userproperties())
                Image:
                    source: self.parent.parent.parent.parent.user.img
                    size: self.parent.width, self.parent.height
                    center: self.parent.center_x, self.parent.pos[1] + self.parent.height/2
                    allow_stretch: True

            Label:
                font_size: 25
                text: self.parent.parent.parent.user.username
                halign:'left'
                valign:'middle'
                text_size: self.size

            Button:
                background_color: 0,0,0,0
                size_hint_x: .1
                on_press: run(self.parent.parent.parent.search())
                Image:
                    source: "app/images/search.png"
                    size: self.parent.width, self.parent.height
                    center: self.parent.center_x, self.parent.pos[1] + self.parent.height/2
                    allow_stretch: True
            Widget:
                size_hint: 0.01, 1
            Button:
                background_color: 0,0,0,0
                size_hint_x: .1
                on_press: run(self.parent.parent.parent.shaire())
                Image:
                    source: "app/images/shaire.png"
                    size: self.parent.width, self.parent.height
                    center: self.parent.center_x, self.parent.pos[1] + self.parent.height/2
                    allow_stretch: True
            
        BaseWidget:
            size_hint: 1, .002
            height: 5

        BaseWidget1:
            size_hint: 1, .002
            height: 5

        ScrollView:
            do_scroll_x: False
            do_scroll_y: True
            size_hint: 1, .9
            size: root.width, self.parent.height

            ScrollLayout:
                orientation: "tb-lr"
                size_hint_x: root.width
                size: root.width, sum([x.size[1] for x in self.children]) + self.spacing[1]*len(self.children) + 50
                spacing: 2


<MessagePage>:
    BoxLayout:
        orientation:"vertical"
        BoxLayout: # fix this at some point
            orientation:"horizontal"
            size_hint: 1, None
            height: self.parent.height * 0.07
            canvas.before:
                Color:
                    rgb: background
                Rectangle:
                    pos: self.pos
                    size: self.size

            Button:
                text:""
                size_hint: .2, .9
                pos_hint: {'y': .05}
                on_press: run(self.parent.parent.parent.back())

                background_color: (0, 0, 0, 0)
                Image:
                    source: "app/images/back.png"
                    size: self.parent.width, self.parent.height
                    center: self.parent.center_x, self.parent.pos[1] + self.parent.height/2
                    allow_stretch: True

            Button:
                text:"Reload (debug)"
                on_press: run(self.parent.parent.parent.reload())
        Widget:
            size_hint: 1, .01

        ScrollView:
            do_scroll_x: False
            do_scroll_y: True
            size_hint: 1, .9
            size: root.width, self.parent.height

            Label:
                size_hint: None, None
                pos: (root.width-self.width) / 2 + 10, self.pos[1]
                text_size: root.width * .95, None
                size: self.texture_size[0]-10, self.texture_size[1]

                markup: True

        BoxLayout:
            orientation: "horizontal"
            width: self.parent.width
            height: self.children[1].size[1]
            size_hint_y: None

            canvas.before:
                Color:
                    rgb: lightbackground
                Rectangle:
                    size: self.size
                    pos: self.pos

            TextInput:
                background_color: lightbackground
                on_text: Clock.schedule_once(lambda x: self.parent.parent.parent.update(self.parent, self.parent.parent.children[1], self), 0)
                canvas.after: Clock.schedule_once(lambda x: self.parent.parent.parent.update(self.parent, self.parent.parent.children[1], self), 1)
                hint_text: 'Send message'
                font_size: 18
                background_color: background
                foreground_color: superbright

                background_normal: 'app/images/background.png'
                background_active: 'app/images/background.png'

                border: 30, 30, 30, 30

                hint_text_color: bright
                size_hint: .8, None
                padding: 20
                height: max(min(5*self.line_height*1.5, self.minimum_height), self.parent.children[0].children[0].width * 1.3)

                keyboard_on_key_down: lambda *arg, **kwargs : self.parent.parent.parent.key(self, *arg, **kwargs)

            Button:
                size_hint: .1, None
                height: self.width*1.3
                background_color: 0,0,0,0
                on_press: run(self.parent.parent.parent.send())
                Image:
                    source: "app/images/send.png"
                    size: self.parent.width, self.parent.height
                    center: self.parent.center_x + self.parent.width/100, self.parent.center_y + self.parent.height/100
                    allow_stretch: True


<SeedgenPage>:
    BoxLayout:
        size_hint: None, None
        orientation: "vertical"
        size: self.parent.width * .9, self.parent.height *.9
        pos: (root.width - self.width) /2, (root.height - self.height) /2
        spacing: 10

        Label:
            size_hint: 1, .4
            text_size: self.size
            text: "Remember or write down this seed it is important and will be necessary to log into your account.\nNOTE: Do not write it on any digital device (especialy online) as that can be a security risk."

        Widget:
            size_hint: 1, .1
        TextInput:
            size_hint: 1, .4
            background_normal: 'app/images/background.png'
            background_active: 'app/images/background.png'
            background_disabled_normal: 'app/images/background.png'
            disabled_foreground_color: superdark

            border: 30, 30, 30, 30
            padding: 20
            disabled: True

            text: "Generating secure key..."
            canvas.after: Clock.schedule_once(lambda x: self.parent.parent.update(self), 0)

        Widget:
            size_hint: 1, .1

        BoxLayout:
            orientation: "horizontal"
            size_hint: 1, .2

            Button:
                size_hint: .4, .5
                text: "Back"
                on_press: self.parent.parent.parent.back()

            Widget:
                size_hint: .2, 1

            Button:
                size_hint: .4, .5
                text: "Next"
                on_press: self.parent.parent.parent.next()


# this is basicly duplicated code couldn't be bothered to fix
<ImportPage>:
    BoxLayout:
        size_hint: None, None
        orientation: "vertical"
        size: self.parent.width * .9, self.parent.height *.9
        pos: (root.width - self.width) /2, (root.height - self.height) /2
        spacing: 10

        Label:
            size_hint: 1, .2
            text_size: self.size
            halign:'center'
            valign:'middle'
            text: ""
            color: error

        Label:
            size_hint: 1, .4
            text_size: self.size
            text: "Enter the words for your seed below separated by a space.\nIf you have forgotten your seed try remember where you wrote it down as it is impossible to recover an account without it."
        Widget:
            size_hint: 1, .1
        TextInput:
            size_hint: 1, .4
            background_normal: 'app/images/background.png'
            background_active: 'app/images/background.png'
            background_disabled_normal: 'app/images/background.png'
            disabled_foreground_color: superdark

            border: 30, 30, 30, 30
            padding: 20

            text_hint: "Enter your seed."

        Widget:
            size_hint: 1, .1

        BoxLayout:
            orientation: "horizontal"
            size_hint: 1, .2

            Button:
                size_hint: .4, .5
                text: "Back"
                on_press: self.parent.parent.parent.back()

            Widget:
                size_hint: .2, 1

            Button:
                size_hint: .4, .5
                text: "Next"
                on_press: run(self.parent.parent.parent.next())